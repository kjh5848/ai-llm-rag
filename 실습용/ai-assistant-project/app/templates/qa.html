{% extends "base.html" %} {% block title %}í†µí•© Q&A ê²€ìƒ‰ - ë©”íƒ€ì½”ë”©{% endblock
%} {% block page_title %}í†µí•© Q&A ê²€ìƒ‰ (Hybrid Search)
<span class="badge badge-success">AI ì—°ë™</span>{% endblock %} {% block
page_subtitle %}ì‚¬ë‚´ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ AIê°€ ë¶„ì„í•˜ì—¬ ê°€ì¥ ì •í™•í•œ ë‹µë³€ì„
ì œì•ˆí•©ë‹ˆë‹¤.
<button
  onclick="clearChatHistory()"
  class="btn-clear-chat"
  title="ëŒ€í™” ë‚´ì—­ ì§€ìš°ê¸°"
>
  ğŸ—‘ï¸ ë‚´ì—­ ì§€ìš°ê¸°
</button>
<div class="mode-toggle">
  <label class="switch">
    <input type="checkbox" id="agentModeToggle">
    <span class="slider round"></span>
  </label>
  <span class="mode-label">ğŸ¤– ì—ì´ì „íŠ¸ ëª¨ë“œ</span>
</div>
{% endblock %} {% block content %}
<!-- ì™¸ë¶€ ìì› ì—°ê²° -->
<link rel="stylesheet" href="/static/css/qa.css?v=20260210_1248" />

<div class="chat-app-container">
  <div id="chatHistory" class="chat-history">
    <!-- ì´ˆê¸° í™˜ì˜ ë©”ì‹œì§€ -->
    <div class="chat-message ai-message">
      <div class="avatar">ğŸ¤–</div>
      <div class="message-content">
        ì•ˆë…•í•˜ì„¸ìš”! ë©”íƒ€ì½”ë”© ì§€ëŠ¥í˜• ë¹„ì„œì…ë‹ˆë‹¤. ì‚¬ë‚´ ê·œì •, ì§ì› ì •ë³´, ë§¤ì¶œ í˜„í™©
        ë“± ê¶ê¸ˆí•œ ì ì„ ë¬¼ì–´ë³´ì„¸ìš”.
      </div>
    </div>

    <!-- ê²€ìƒ‰ ê²°ê³¼ê°€ ìˆìœ¼ë©´ í‘œì‹œ (SSR ëŒ€ì‘) -->
    {% if query %}
    <div class="chat-message user-message">
      <div class="message-content">{{ query }}</div>
    </div>
    {% endif %} {% if results %}
    <div class="chat-message ai-message">
      <div class="avatar">ğŸ¤–</div>
      <div class="message-content">
        <div class="ai-ans-text">
          {% if ai_answer %} {{ ai_answer | replace('\n', '<br />') | safe }} {%
          else %} ë‹µë³€ì„ ì¤€ë¹„í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”. {% endif %}
        </div>

        <!-- ìƒì„¸ ê·¼ê±° ì„¹ì…˜ -->
        <div class="source-container">
          <div
            class="source-header"
            onclick="this.parentElement.classList.toggle('active')"
          >
            <span>ğŸ” ë¶„ì„ ê·¼ê±° ë³´ê¸° (RAG + SQL)</span>
            <i class="arrow">â–¼</i>
          </div>
          <div class="source-body">
            <div class="source-grid">
              <div class="source-column">
                <h5>ğŸ“š ë¬¸ì„œ ê²€ìƒ‰ ê²°ê³¼</h5>
                {% for item in results.unstructured %}
                <div class="source-item">
                  <small>{{ item.source }}</small>
                  <p>{{ item.content[:150] }}...</p>
                </div>
                {% else %}
                <p class="no-data">ê´€ë ¨ ë¬¸ì„œ ì—†ìŒ</p>
                {% endfor %}
              </div>
              <div class="source-column">
                <h5>ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ</h5>
                {% if results.structured.employees %}
                <div class="source-item">
                  ì§ì› ì •ë³´: {{ results.structured.employees|length }}ê±´
                </div>
                {% endif %} {% if results.structured.leaves %}
                <div class="source-item">íœ´ê°€ ì •ë³´ ë°œê²¬</div>
                {% endif %} {% if results.structured.sales %}
                <div class="source-item">ê´€ë ¨ ë§¤ì¶œ ë°ì´í„° ë°œê²¬</div>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endif %}
  </div>

  <!-- ë¡œë”© ìŠ¤í”¼ë„ˆ (JSì—ì„œ ì œì–´) -->
  <div id="loadingIndicator" class="loading-indicator" style="display: none">
    <div class="spinner"></div>
    <span>ë©”íƒ€ì½”ë”© AIê°€ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</span>
  </div>

  <!-- ì§ˆë¬¸ ì…ë ¥ë°” (í•˜ë‹¨ ê³ ì •) -->
  <div class="chat-footer">
    <form id="qaForm" class="chat-input-form">
      <input
        type="text"
        id="queryInput"
        placeholder="ì¸ì‚¬ ê·œì •ì´ë‚˜ ì˜ì—…íŒ€ ë§¤ì¶œì— ëŒ€í•´ ë¬¼ì–´ë³´ì„¸ìš”..."
        autocomplete="off"
        required
        class="form-control chat-input"
        style="margin-bottom: 0 !important"
      />
      <button type="submit" class="btn-send">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <path fill="currentColor" d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
        </svg>
      </button>
    </form>
  </div>
</div>

<script src="/static/js/qa.js?v=20260210_1242"></script></script>
{% endblock %}
