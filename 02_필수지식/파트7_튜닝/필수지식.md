# 파트 7. RAG 튜닝 및 고도화: 답변 품질의 한계를 극복하는 기술 레퍼런스

이 문서는 프로토타입 수준의 RAG를 상용 서비스 수준으로 끌어올리기 위한 검색 정밀도 향상 및 최적화 전략을 다룹니다.

---

## 7.1 기술적 기원: 왜 로컬 RAG는 고도화 튜닝이 필수적인가?
*   **프로토타입의 한계**: 단순히 벡터 검색만으로는 "비슷해 보이지만 틀린" 문서를 가져오거나, 최신성/우선순위 구분을 못 하는 등 현업 적용이 어려운 경우가 빈번합니다.
*   **품질의 임계점**: AI 비서가 "똑똑하다"고 느끼게 하려면 의미 검색의 모호함을 제거하는 정교한 수학적/논리적 필터링 단계가 필요합니다.

## 7.2 아키텍처 설계: 답변 품질 향상을 위한 고급 튜닝 전략
*   **ReRanker (재순위화)**: 벡터 검색으로 빠르게 추출한 상위 N개 문서를, 더 똑똑한 모델(Cross-Encoder)로 다시 한번 정밀 채점하여 순위를 재조정하는 과정입니다.
*   **Hybrid Search**: 벡터 기반의 '의미 검색'과 전통적인 '키워드 매칭(BM25)'의 장점을 가중치(Convex Combination)를 주어 섞어 쓰는 방식입니다.
*   **Query Expansion (질문 확장)**: 사용자의 짧고 모호한 질문을 의미가 풍부한 여러 문장으로 변환하거나, 가상의 답변(HyDE)을 생성하여 검색의 접점을 넓히는 기술입니다.

## 7.3 작동 메커니즘: 시스템 내에서의 핵심 역할
*   **정밀 타격 (Recall to Precision)**: 1차로 많이 가져온 뒤(재현율), 2차에서 정확한 것만 골라내는(정밀도) 2단계 파이버라인(Two-stage Pipeline)을 가동합니다.
*   **최신성 및 우선순위 필터링**: 메타데이터를 활용하여 최신 날짜의 문서에 가중치를 주거나, 특정 보안 등급의 문서를 제외합니다.
*   **문맥 보강 (Parent Document Retrieval)**: 검색은 '작은 조각'으로 하되, LLM에게는 그 조각이 포함된 '전체 단락(부무 문서)'을 전달하여 의미의 끊김을 방지합니다.

## 7.4 비즈니스 전략: RAG 고도화 도입의 실무적 근거
*   **사용자 신뢰 확보**: 10번 중 1번만 틀려도 사용자는 업무에 AI를 쓰지 않습니다. 그 1번의 오답을 잡기 위해 튜닝이 필요합니다.
*   **전문 용어 대응**: 우리 회사만 쓰는 축약어나 프로젝트명은 일반 벡터 검색만으로는 한계가 있으며, 키워드 검색을 섞어야 답변이 정확해집니다.
*   **응답 일관성**: 유사한 질문에 대해 항상 통계적으로 가장 우수한 근거 문서를 참조하도록 고정하기 위함입니다.

## 7.5 트레이드오프: 튜닝 및 최적화 과정의 강점과 제약 사항
*   **장점**
    *   **압도적 정확도**: 단순 RAG 대비 정답률이 30~50% 이상 향상됩니다.
    *   **데이터 이해도 상승**: 전처리 과정에서 데이터의 문제점(중복, 누락)을 파악하고 정정할 기회가 생깁니다.
*   **단점**
    *   **지연 시간 증가**: ReRanking 과정을 거치면 사용자 응답 속도가 1~2초가량 더 소요될 수 있습니다.
    *   **복잡한 튜닝값**: 키워드와 벡터의 가중치 비율(예: 0.3:0.7)을 찾는 실험적 과정이 필요합니다.

## 7.6 비교 우위: Naive RAG와의 결정적 차이점
*   **Naive RAG vs Advanced RAG**:
    *   Naive는 "가져와서 읽어라" 수준이지만, Advanced는 "가져온 것 중 최고를 골라 읽어라"는 전략이 포함됩니다.
*   **Vector Only vs Hybrid**:
    *   Vector Only는 은유나 상징 이해에 좋고, Hybrid는 특정 품번이나 법령 번호 같은 '정확한 단어' 매칭에 강합니다.

## 7.7 연관 생태계: 검색 품질 고도화 통합 스택
*   **BGE-Reranker / Cohere Rerank**: 검색 결과 가공의 표준 모델.
*   **BM25 (Rank-BM25)**: 고전적이지만 가장 강력한 키워드 기반 코퍼스 점계 알고리즘.
*   **HyDE (Hypothetical Document Embeddings)**: 가상의 답변을 먼저 생성해 검색 효율을 높이는 기법.

---
**실습 연결 포인트**:
- 검색 품질 개선을 위한 고급 청킹 기법과 메타데이터 활용법은 `01_basic_rag/docs/청킹심화.md`의 상세 가이드를 통해 학습할 수 있습니다.
