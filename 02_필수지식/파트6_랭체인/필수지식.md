# 파트 6. LangChain 오케스트레이션: 시스템 연결 및 워크플로우 제어 레퍼런스

이 문서는 LLM, VectorDB, API 등을 하나로 묶어 유기적인 서비스를 만드는 통합 프레임워크의 구조와 설계 철학을 다룹니다.

---

## 1. 탄생 배경 (Context & Background)
*   **컴포넌트의 파편화**: 모델(Ollama), 저장소(Chroma), 웹(FastAPI) 등 각기 다른 기술을 일일이 수동으로 연동하는 것은 개발 생산성을 크게 저해합니다.
*   **기술의 빠른 교체**: 오늘 쓰는 LLM이나 DB가 내일 더 좋은 것으로 바뀌더라도, 비즈니스 로직(코드)은 최소한으로 수정되어야 하는 요구가 생겼습니다.

## 2. 핵심 개념 (Core Concepts)
*   **LCEL (LangChain Expression Language)**: 복잡한 연쇄 과정(`프롬프트 -> 모델 -> 파서`)을 파이프(`|`) 기호를 사용하여 직관적이고 선언적으로 작성하는 문법입니다.
*   **Runnables**: 모든 연결 부품이 공유하는 공통 규격으로, 동기/비동기/스트리밍/배치 연산을 일관되게 처리할 수 있게 합니다.
*   **Memory (메모리)**: 단발성 질문이 아닌 앞선 대화의 흐름을 기억하여 맥락 있는 소통(Multi-turn)을 가능하게 하는 모듈입니다.

## 3. 역할 (Role & Mechanics)
*   **표준 인터페이스 제공**: 어떤 LLM 모델을 쓰더라도 같은 `invoke()` 함수로 호출할 수 있는 추상화 계층 역할을 합니다.
*   **데이터 파이프라인 제어**: 입력된 질문을 다듬고(Prompt), 결과물에서 필요한 데이터만 추출(Parser)하는 전체 공정을 자동화합니다.
*   **재시도 및 폴백 (Retry/Fallback)**: 모델 호출이 실패했을 때 자동으로 다시 시도하거나, 대안 모델로 전환하여 시스템 안정성을 유지합니다.

## 4. 도입 이유 (Rationale)
*   **생태계 연동성**: 수백 개의 VectorDB와 수천 개의 도구가 이미 LangChain용으로 개발되어 있어, 새로운 기술 도입 시 연동 비용이 거의 0에 가깝습니다.
*   **복잡한 워크플로우 관리**: 조건별 분기나 순환 구조를 가진 에이전트 로직을 체계적으로 설계하기 위해 필수적입니다.
*   **코드 유지보수**: 비즈니스 로직과 기술 엔진이 분리되어 있어, 시스템이 커져도 스파게티 코드가 되지 않습니다.

## 5. 장단점 (Analysis)
*   **장점**
    *   **강력한 추상화**: 하부 구현체(어떤 DB인지, 어떤 모델인지)를 몰라도 상위 로직을 짤 수 있습니다.
    *   **스트리밍 지원**: 답변이 생성되는 대로 사용자에게 즉시 보여주는 기능을 매우 쉽게 구현합니다.
*   **단점**
    *   **잦은 업데이트**: 라이브러리가 너무 자주 업데이트되어 버전 관리가 까다롭습니다.
    *   **과도한 추상화**: 내부 동작을 깊이 이해하지 않고 쓰면 오류가 났을 때 디버깅이 어려울 수 있습니다.

## 6. 차별점 (Competitive Analysis)
*   **vs 직접 API 호출**: 직접 짜면 가볍지만, 스트리밍, 재시도, 로그 추적 등을 모두 직접 구현해야 하는 막대한 공수가 듭니다.
*   **vs LlamaIndex**: LlamaIndex는 '데이터 검색과 로딩'에 더 깊은 전문성을 가지며, LangChain은 '범용적인 에이전트 워크플로우'와 '애플리케이션 통합'에 더 강점이 있습니다.

## 7. 관련 기술 (Related Technology)
*   **LangGraph**: 상태를 가진 순환(Cycle) 그래프 에이전트 설계 도구.
*   **LangSmith**: LLM 앱의 성능을 모니터링하고 디버깅하는 플랫폼.
*   **LCEL**: 체인을 효율적으로 조립하기 위한 전용 언어.

---
**실습 연결 포인트**:
- LCEL을 이용한 체인 구성과 스트리밍 응답 구현은 `01_basic_rag/tutorial_step5_finish.md` 및 해당 단계의 코드에서 핵심적으로 다루고 있습니다.
