# 파트 2. 사내 문서 수집 및 정제 전략: 기술 상세 레퍼런스

이 문서는 RAG 시스템의 성능을 결정짓는 가장 중요한 요소인 '데이터 품질 전문 관리'와 '비정형 데이터의 구조화' 전략을 다룹니다.

---

## 1. 탄생 배경 (Context & Background)
*   **GIGO (Garbage In, Garbage Out)**: LLM의 추론 능력이 아무리 뛰어나도, 입력되는 문서 조각(Context)이 부정확하거나 전처리가 부실하면 결과물도 무의미해집니다.
*   **비정형 데이터의 복잡성**: 사내 문서는 PDF, Word, Excel 등 포맷이 제각각이며, 표(Table), 이미지, 계층적 구조(Heading) 등이 섞여 있어 기계적 읽기가 매우 어렵습니다.

## 2. 핵심 개념 (Core Concepts)
*   **Parsing (파싱)**: 원본 파일(바이너리)에서 유의미한 텍스트와 레이아웃 정보를 추출하는 과정입니다.
*   **Chunking (청킹)**: 방대한 문서를 LLM이 한 번에 처리할 수 있는 최적의 크기로 분할하는 작업입니다.
*   **Context Window**: 모델이 한 번에 '볼 수 있는' 토큰의 한계치로, 청킹 사이즈 결정의 물리적 기준이 됩니다.

## 3. 역할 (Role & Mechanics)
*   **지식의 구조화**: 줄글 형태의 텍스트를 제목-본문-메타데이터 형태의 '검색 가능한 단위'로 재구성합니다.
*   **메타데이터 인젝션**: 단순히 텍스트만 저장하는 것이 아니라 생성일, 저자, 부서, 보안 등급 등의 정보를 꼬리표로 붙여 검색의 정밀도를 높입니다.
*   **노이즈 제거**: 불필요한 특수문자, 중복 공백, OCR 오류 등을 정제하여 임베딩 모델의 정확도를 개선합니다.

## 4. 도입 이유 (Rationale)
*   **검색 성능 최적화**: 적절한 크기로 잘린 문서는 벡터 공간에서 더 뚜렷한 의미 좌표를 갖게 됩니다.
*   **토큰 비용 관리**: 검색된 정보가 너무 길면 LLM 호출 비용(혹은 로컬 연산 시간)이 증가하므로 효율적인 압축이 필요합니다.
*   **다양한 포맷 지원**: 회사 내 산재한 HWP, PDF, Excel 데이터를 하나의 통합된 데이터 스트림으로 변환하기 위해 표준화된 파이프라인이 필요합니다.

## 5. 장단점 (Analysis)
*   **장점**
    *   **정확도 향상**: 문서의 계층 구조를 보존하며 잘랐을 때 검색 가독성이 획기적으로 좋아집니다.
    *   **관리 효율**: 메타데이터를 활용하여 실시간 권한 제어(ACL)가 가능해집니다.
*   **단점**
    *   **전처리 복잡도**: 표(Table)나 수식이 많은 문서는 고도의 파이싱 기술(Layout-aware parsing)이 요구됩니다.
    *   **정보 손실 위험**: 청킹 과정에서 앞뒤 문맥이 끊기면 의미가 왜곡될 수 있습니다.

## 6. 차별점 (Competitive Analysis)
*   **단순 텍스트 추출 vs 구조적 파싱**: 
    *   단순 추출은 문서의 흐름을 파괴하지만, 구조적 파싱(Markdown 변환 등)은 제목과 본문의 관계를 유지하여 AI의 이해 돕습니다.
*   **고정 크기 청킹 vs 의미 단위 청킹**:
    *   고정 크기(Fixed-size)는 구현이 쉽지만 문장을 무작위로 자르는 반면, 의미 단위(Recursive character) 청킹은 문맥의 마침표나 단락을 기준으로 유연하게 작동합니다.

## 7. 관련 기술 (Related Technology)
*   **PyPDF / pypdf**: PDF 텍스트 추출의 표준 라이브러리.
*   **python-docx / openpyxl**: 워드 및 엑셀 정형화 도구.
*   **RecursiveCharacterTextSplitter**: 문맥을 최대한 보존하며 문서를 자르는 알고리즘.

---
**실습 연결 포인트**:
- 문서 수집 및 표준화 실습은 `01_basic_rag/tutorial_step2_context.md`와 해당 단계에서 문서를 로드하고 리스트를 만드는 과정을 통해 직접 확인하실 수 있습니다.
