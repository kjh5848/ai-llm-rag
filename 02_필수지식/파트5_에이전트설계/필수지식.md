# PART 5. 정형 MCP, 비정형 VectorDB+RAG: 통합 에이전트 설계

## 1. 📌 탄생 배경 (Background)
- **RAG의 한계**: RAG는 텍스트(비정형) 검색은 잘하지만, "이번 달 총 매출은?" 같은 **정확한 숫자 계산/집계**는 못함 (할루시네이션 발생).
- **정형 데이터 활용**: 회사 정보의 절반은 DB(SQL)에 있음. 이를 AI가 활용하려면 RAG가 아닌 다른 방식(Tool/SQL)이 필요.

## 2. 🔑 개념 (Concept)
- **Agent (에이전트)**: 스스로 도구(Tool)를 선택하고 판단하여 행동하는 AI.
- **Routing (라우팅)**: 질문의 의도를 파악하여 적절한 처리 경로(DB 조회 vs 문서 검색)로 보내는 기술.
- **MCP (Tool)**: AI가 외부 함수(DB Query, API Call)를 실행할 수 있게 해주는 인터페이스.

## 3. ⚙️ 역할 (Role)
- **기술적 3B (Brain, Body, Bridge)**: LLM(Brain)이 도구(Body)를 사용하여 외부 시스템(Bridge)과 상호작용.
- **통합 해결사**: "김대리 연차(DB) 몇 개 남았고, 규정(문서)은 뭐야?" 같은 복합 질문 해결.

## 4. 💡 도입 이유 (Reason)
- **정확성 분리**: 
  - 숫자는 **DB**에서 정확하게 가져와야 함 (사실).
  - 설명은 **문서**에서 찾아야 함 (맥락).
  - 이 둘을 섞어서 완벽한 답변을 주기 위함.

## 5. ⚖️ 장단점 (Pros & Cons)
| 구분 | 내용 |
| :--- | :--- |
| **장점** | - **전지전능함**: 정형/비정형 데이터를 가리지 않고 답변 가능.<br>- **확장성**: 날씨 API, 주식 API 등 도구만 추가하면 능력이 무한 확장됨. |
| **단점** | - **복잡도**: 라우팅 로직이 꼬이면 엉뚱한 도구를 호출할 수 있음.<br>- **속도**: 판단 단계가 추가되어 단순 RAG보다 응답 속도가 느림. |

## 6. 🆚 차별점 (Differences)
- **vs Simple RAG**: 
  - RAG는 "읽기"만 가능하지만, Agent는 "행동(조회, 계산, 실행)"이 가능함.
- **vs SQL Chatbot**: 
  - SQL 챗봇은 문서 내용을 모르지만, 통합 에이전트는 문서와 DB를 모두 앎.

## 7. 🔗 관련 기술 (Related Tech)
- **RouterChain**: 질문 분류기 (예: "매출" 키워드 -> SQL 도구, "규정" 키워드 -> RAG 도구).
- **Function Calling**: LLM이 자연어를 보고 실행해야 할 함수명과 인자를 JSON으로 뽑아주는 기능.
- **SQLAgent**: 자연어를 SQL 쿼리로 변환하여 DB를 조회하는 LangChain 에이전트.
