# 파트 5. 통합 에이전트 설계: 정형/비정형 데이터 결합 레퍼런스

이 문서는 문서(비정형)와 데이터베이스(정형)를 동시에 다루며, 질문에 따라 적절한 도구를 선택하는 지능형 에이전트 설계 방식을 다룹니다.

---

## 5.1 기술적 기원: 왜 단일 RAG를 넘어 통합 에이전트가 필요한가?
*   **지식의 이원성**: 기업 지식은 '규정(문서)'과 '수치(DB)'라는 두 가지 형태로 공통 존재합니다. "휴가 규정이 뭐야?"는 RAG가 답하지만, "박 대리의 남은 휴가는?"은 DB 조회가 필요합니다.
*   **복합 질문의 증대**: 사용자는 하나의 질문 안에 두 데이터를 모두 요구하는 경우가 많아, 이를 유기적으로 처리할 '두뇌(Agent)'가 필수적입니다.

## 5.2 아키텍처 설계: 지능형 판단 및 도구 연동의 핵심 정의
*   **Agent (에이전트)**: 고정된 흐름(Chain)을 따르지 않고, LLM이 상황에 맞게 어떤 행동을 할지 스스로 추론하고 결정하는 루프를 의미합니다.
*   **Tool Calling / Function Calling**: LLM이 특정 함수(DB 조회, 웹 검색 등)를 실행하기 위해 필요한 인자값을 스스로 생성하는 기술입니다.
*   **Router (라우터)**: 사용자의 의도(Intent)를 분석하여 RAG 검색기로 보낼지, 아니면 DB 조회 도구로 보낼지 결정하는 신호등 역할을 수행합니다.

## 5.3 작동 메커니즘: 시스템 내에서의 핵심 역할
*   **의도 파악 (Intent Classification)**: "몇 명인가요?"와 같은 질문에서 '수량 파악(SQL 조회)' 의도를 추출해냅니다.
*   **도구 선택 (Tool Selection)**: 가용한 도구들의 이름과 설명을 읽고, 현재 질문 해결에 가장 적합한 도구를 골라 호출합니다.
*   **정보 통합 (Reasoning & Synthesis)**: 문서에서 얻은 정보와 DB에서 얻은 숫자를 결합하여 하나의 완결된 문장으로 재구성합니다.

## 5.4 비즈니스 전략: 통합 에이전트 도입의 실무적 근거
*   **다목적 해결 능력**: 하나의 채팅창에서 문서 검색부터 이사 결재, 재고 조회까지 모든 업무를 지원하기 위함입니다.
*   **사용자 경험 극대화**: 사용자가 질문의 성격에 따라 메뉴를 고를 필요 없이, 자연어로만 소통해도 시스템이 알아서 판단하게 합니다.
*   **시스템 확장성**: 새로운 도구(예: ERP 연동)가 추가되어도 전체 로직을 바꾸지 않고 에이전트에게 도구 설명만 추가하면 즉시 적용 가능합니다.

## 5.5 트레이드오프: 에이전트 기반 아키텍처의 강점과 제약 사항
*   **장점**
    *   **범용성**: 다양한 데이터 소스를 하나의 앱으로 통합할 수 있습니다.
    *   **지능형 대응**: 예상치 못한 질문에도 가용한 도구를 활용해 유연하게 대처합니다.
*   **단점**
    *   **불확실성**: 루프를 돌면서 예기치 않은 행동을 할 수 있어 제어가 어렵습니다.
    *   **지연 및 비용**: 에이전트가 고민하는 단계(Reasoning)와 여러 번의 도구 호출로 인해 응답 시간이 길어집니다.

## 5.6 비교 우위: 단순 선형 체인(Chain)과의 결정적 차이점
*   **단순 Chain vs Agentic Flow**:
    *   Chain은 정해진 순서(A -> B -> C)만 따르지만, Agent는 질문에 따라 A를 생략하거나 B를 두 번 호출하는 등 유동적으로 움직입니다.
*   **RAG Only vs RAG + MCP**:
    *   RAG 전용 시스템은 텍스트 정보에 갇혀 있지만, 통합 에이전트는 현실 세계의 살아있는 데이터(DB)와 상시 동기화됩니다.

## 5.7 연관 생태계: 에이전트 워크플로우 및 프로토콜 통합 스택
*   **LangGraph**: 상태(State)를 가진 복잡한 에이전트 워크플로우를 설계하기 위한 최상위 도구.
*   **MCP (Model Context Protocol)**: 에이전트가 외부 도구와 소통하는 표준 언어.
*   **PydanticOutputParser**: 에이전트가 결과를 JSON 등 기계가 읽기 쉬운 구조로 내뱉게 강제하는 기술.

---
**실습 연결 포인트**:
- 에이전트의 기본적인 판단 로직과 도구 선택 흐름은 `01_basic_rag/tutorial_step4_reasoning.md`와 해당 파이썬 코드의 에이전트 정의 부분에서 상세히 실습할 수 있습니다.
