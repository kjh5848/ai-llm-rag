# 10장. RAG 튜닝: "되는 수준"에서 "쓸만한 수준"으로

## 1. 목차 개요
- **목적**: 이 파트가 책의 하이라이트. 실전 문제를 해결하는 순서대로 구성

## 2. 주요 내용
### 10.1 증상별 튜닝 가이드
- **엉뚱한 문서**: 검색 품질 낮음 -> ReRanker, Hybrid Search
- **근거 부족**: 출처 추적 미흡 -> 메타데이터 강화, 프롬프트 수정
- **환각(Hallucination)**: 지어냄 -> 프롬프트 튜닝, 근거 강제
- **과거 데이터 인용**: 버전 관리 미흡 -> metadata filtering
- **핵심 파악 실패**: 청크 설계 문제 -> Parent Document Retriever

### 10.2 Chunk/Retriever 튜닝
- **Semantic chunk**: 제목/문단 기반으로 전환
- **k값/Similarity threshold** 설정
- **Metadata filtering**: 최신 버전만, 부서별 필터

### 10.3 고급 기술 적용
- **ReRanker**: 1차 검색 후 재순위화 (Cross-Encoder, Cohere, BGE)
- **Hybrid Search**: 키워드(BM25) + 벡터 결합
- **고급 Retriever**: Parent Document Retriever, Self-Query, Contextual Compression
- **Query Rewrite**: Multi-Query, HyDE, 동의어 처리

### 10.4 프롬프트 튜닝
- 근거 우선 프롬프트 작성법
- "모르면 모른다" 강제 지시
- 답변 포맷 고정 (JSON, 표 형식)

### 10.5 PDF 이미지 처리 전략 (하이브리드 방식)
- **문제**: DeepSeek R1은 텍스트 LLM (이미지 이해 불가)
- **해결**: LLaVA(이미지 캡션 생성) + EasyOCR(텍스트 추출)
- **메모리별 구성**: 16GB+ (Hybrid), 8-12GB (Hybrid 경량), 4-8GB (OCR 중심)

### 10.6 평가 체계 (필수!)
- 테스트 질문 세트 (30개 이상)
- 정답 데이터셋 (예상 답변 + 출처 매핑)
- 지표: Retrieval 정확도, Answer 정확도, Hallucination Rate
