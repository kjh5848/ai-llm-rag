# 5장. 지식의 디지털화: 문서를 AI가 읽도록 만들기

RAG 시스템의 성능은 문서 품질에 직결됩니다. 아무리 똑똑한 모델이라도 깨진 글자를 주면 엉뚱한 답을 합니다. 본 장에서는 PDF와 이미지 같은 **비정형 데이터** 를 AI가 이해하기 가장 좋은 형식인 **Markdown** 으로 통합하여 지식화하는 과정을 실습합니다.

---

## 1. 왜 굳이 Markdown으로 변환해야 하나요?

**"그냥 PDF 그대로 벡터 DB에 넣으면 안 되나요?"** 라고 질문합니다. 결론부터 말씀드리면 **"가능은 하지만, 성능이 현저히 떨어집니다."**

AI(LLM)에게 **Markdown** 은 사람의 **표준어**와 같습니다.

1. **구조의 보존**: 단순 텍스트는 표나 목록의 구조가 깨지지만, Markdown은 `# 헤더`, `| 표 |`, `- 목록`을 통해 문서의 구조를 완벽하게 보존합니다.
2. **토큰 효율성**: HTML이나 XML 같은 태그보다 훨씬 적은 토큰으로 동일한 정보를 표현하여 비용을 절감합니다.
3. **LLM 친화적**: GPT를 비롯한 모든 최신 LLM은 인터넷상의 수억 개 코드를 학습하며 Markdown 문법을 네이티브 언어처럼 익혔습니다. 따라서 Markdown으로 주어졌을 때 내용을 가장 정확하게 이해합니다.

## 즉, **5장은 'PDF라는 외계어'를 AI가 가장 잘 알아듣는 '표준어(Markdown)'로 번역하는 과정** 입니다.

## 2. 사내 문서 수집 전략과 문서 표준 만들기

문서를 무작정 수집한다고 해서 좋은 지식 베이스가 되는 것은 아닙니다. RAG 시스템의 검색 품질을 높이기 위해 어떤 데이터를 선별하고 어떻게 표준화해야 하는지 구체적인 전략을 알아보겠습니다.

### 2.1 문서 수집 대상 (Target Artifacts)

RAG 도입 초기에는 모든 문서를 다 넣기보다, **AI가 답변하기 쉽고 사용자 만족도가 높은** 문서를 우선순위로 선정해야 합니다. 무작정 많은 데이터를 넣으면 오히려 검색 정확도가 떨어질 수 있습니다(Garbage In, Garbage Out).

> **용어 설명: Garbage In, Garbage Out (GIGO)**
> '쓰레기가 들어가면 쓰레기가 나온다'는 뜻으로 컴퓨터 과학의 유명한 격언입니다. RAG에서도 마찬가지로 **품질이 낮은 문서(Garbage In)**가 벡터 DB에 저장되면, 아무리 뛰어난 AI 모델이라도 **엉뚱한 답변(Garbage Out)**을 내놓을 수밖에 없음을 의미합니다.

성공적인 RAG를 위한 **'좋은 데이터'의 3가지 조건**은 다음과 같습니다.

1. **명확한 정답(Ground Truth)**: "규정에 따르면...", "매뉴얼 3페이지에..." 처럼 출처가 명확하고 팩트 위주인 문서.
2. **구조화된 형식(Structured)**: 목차, 개조식 설명 등 구조가 잡혀있어 AI가 맥락을 끊어(Chunking) 읽기 좋은 문서.
3. **높은 검색 빈도(High Frequency)**: 직원들이 업무 중 반복적으로 검색하는 정보(HR, IT 장애 등)여야 구축 효과를 체감할 수 있습니다.

이러한 기준에 부합하는 **핵심 수집 대상**은 다음과 같습니다.

| 분류            | 예시 데이터                                | 비고                                 |
| :-------------- | :----------------------------------------- | :----------------------------------- |
| **사내 규정**   | 인사/휴가/근태/보안 규정                   | 가장 빈번하게 검색되는 정답형 데이터 |
| **업무 매뉴얼** | 신입사원 온보딩, 결재/보고 프로세스        | 업무 흐름 파악에 필수                |
| **기술 문서**   | 운영 가이드, 장애 대응(Runbook), 배포 절차 | 엔지니어를 위한 문제 해결 지식       |
| **교육 자료**   | 사내 교육 슬라이드, 핸드북                 | 핵심 내용이 요약되어 있어 RAG에 적합 |
| **FAQ**         | 자주 묻는 질문/답변 모음                   | Q&A 쌍으로 된 최고의 데이터셋        |

> **질문: 100페이지짜리 '취업규칙' 통으로 넣어도 되나요?**
> **권장은 '주제별 분리'입니다.** 인사, 휴가, 보안 규정이 한 파일에 섞여 있으면 AI가 문맥을 혼동할 수 있습니다.
> 가능하다면 `인사규정.pdf`, `휴가규정.pdf` 처럼 파일을 쪼개주세요. 파일명 자체가 AI에게 강력한 힌트(메타데이터)가 되어 검색 정확도가 비약적으로 상승합니다.

### 2.2 문서 형식 지원 범위

다양한 포맷의 문서를 어떻게 처리할지에 대한 가이드라인입니다.

| 형식               | 지원 여부   | 처리 전략                                   |
| :----------------- | :---------- | :------------------------------------------ |
| **Markdown (.md)** | **Best**    | 별도 처리 없이 즉시 사용 가능               |
| **PDF (.pdf)**     | ✅          | 텍스트 추출 및 구조화 필요 (본 장에서 실습) |
| **Word (.docx)**   | ✅          | `python-docx` 라이브러리로 텍스트 변환      |
| **Excel (.xlsx)**  | ✅          | 표 데이터를 마크다운/CSV로 변환             |
| **HWP (.hwp)**     | **Caution** | 호환성 문제로 PDF 변환 후 처리를 권장       |

### 2.3 형식별 변환 파이프라인과 AI의 역할

각 파일 형식마다 "어떻게 Markdown으로 바꾸는지", 그리고 "AI가 어디서 개입하는지" 전략이 다릅니다. 비용과 정확도를 고려하여 최적의 도구를 선택해야 합니다.

#### 1. PDF (.pdf) & HWP (.hwp)

가장 까다로운 형식입니다. 텍스트 추출 자체는 쉽지만, **'구조 복원'** 이 어렵습니다. 특히 **HWP는 1차로 PDF 저장** 후 처리하는 것을 권장합니다.

- **변환 순서**:
  - **PDF (.pdf)**:
    ```mermaid
    graph LR
        A[PDF 문서] --> B[PyMuPDF: 텍스트/이미지 추출]
        B --> C{AI 교정 요청}
        C --> D[깔끔한 마크다운 저장]
    ```
  - **HWP (.hwp)**:
    ```mermaid
    graph LR
        A[HWP 파일] -->|전용 도구| B(PDF로 저장)
        B --> C[PDF 변환 흐름 위임]
        C --> D[깔끔한 마크다운 저장]
    ```
- **AI의 역할**: **"문맥 교정자(Context Cleaner)"**. 줄바꿈이 엉망이거나 표가 깨진 텍스트를 읽고, 앞뒤 문맥을 파악하여 깔끔한 마크다운 문법으로 다시 써줍니다.

> **팁: HWP 파일은 어떻게 하나요?**
> HWP 전용 파이썬 라이브러리(`pyhwp` 등)가 있지만, 설정이 복잡하고 표가 깨지는 경우가 많습니다.
> 가장 확실하고 간단한 방법은 **'PDF로 저장'**하여 AI에게 제공하는 것입니다. 어떤 도구(한컴오피스, 폴라리스, 클라우드 변환기 등)를 쓰든 상관없습니다. 레이아웃이 유지된 PDF만 있다면, DeepSeek와 같은 고성능 LLM이 완벽하게 문서를 이해할 수 있습니다.

#### 2. Word (.docx) & Excel (.xlsx)

이미 구조화된 문서이므로 AI 없이도 처리가 가능합니다.

- **변환 순서**:
  ```mermaid
  graph LR
      A[Office 파일] --> B{라이브러리 처리}
      B -->|python-docx| C[Word 텍스트 추출]
      B -->|pandas| D[Excel 표 추출]
      C --> E[프로그램 규칙 적용]
      D --> E
      E --> F[마크다운 저장]
  ```
- **AI의 역할**: **"없음(None)"** 또는 **"요약자(Summarizer)"**. 단순 변환에는 AI가 필요 없습니다. 다만 내용이 너무 길어 요약이 필요할 때만 선택적으로 사용합니다.

#### 3. 이미지 (Image in PDF/PPT)

텍스트가 전혀 없는 픽셀 덩어리이므로 AI가 필수입니다.

- **변환 순서**:
  ```mermaid
  graph LR
      A[이미지/차트 추출] --> B[OCR: 텍스트 영역 처리]
      A --> C[Vision LLM: 의미 분석]
      B --> D[결합 및 구조화]
      C --> D
      D --> E[마크다운 해설 저장]
  ```
- **AI의 역할**: **"해설자(Interpreter)"**. "이 차트는 매출이 우상향하고 있음을 보여줍니다"와 같이 이미지의 **의미** 를 텍스트로 번역해 줍니다.

### 2.3 문서 표준 규칙 (RAG 품질의 핵심)

AI가 문서를 헷갈리지 않게 하기 위한 최소한의 규칙입니다.

1. **파일명 규칙**: `{부서}_{문서종류}_{버전}.pdf` (예: `HR_휴가규정_v2.0.pdf`)
2. **메타데이터**: 문서 상단에 YAML 형태로 문서명, 버전, 발행일 등을 명시합니다.
3. **섹션 헤더 규칙**: `##`, `1.`, `1.1` 등 통일된 계층 구조를 사용합니다.
4. **개정 이력**: 문서 상단에 최신 수정 내역을 기록하여 AI가 최신 정보를 우선하도록 유도합니다.

### 2.4 문서 수집 파이프라인 (폴더 구조)

실습에서는 아래와 같이 주제별로 폴더를 나누어 데이터를 관리합니다.

**왜 폴더를 나눠야 할까요?**

1. **메타데이터 자동화**: 폴더명(`hr`, `security`) 자체가 문서의 **'카테고리(Category)'** 메타데이터가 됩니다.
2. **검색 범위 제어**: 나중에 "인사 규정에서만 찾아줘"라고 할 때, `hr` 폴더만 검색하도록 필터링할 수 있습니다.

```
docs/
├── hr/          # 인사 및 휴가 규정
├── ops/         # 운영 및 업무 매뉴얼
├── security/    # 보안 정책 문서
├── onboarding/  # 신입사원 교육 자료
└── faq/         # 자주 묻는 질문
```

---

## 3. 마무리

5장에서는 RAG 시스템을 위한 **문서 수집 전략**과 **표준화 원칙** 을 수립했습니다.

- **데이터 선별**: 품질 낮은 문서는 과감히 버리고, 정답이 명확한 규정과 매뉴얼을 우선순위로 둡니다.
- **변환 전략**:
  - **비정형(PDF/HWP/Image)**: AI의 맥락 이해 능력을 빌려 구조와 의미를 복원합니다.
  - **정형(Office)**: 규칙 기반 변환(Rule-based)으로 비용 효율성을 극대화합니다.
- **구조화**: 폴더명 자체가 메타데이터가 되도록 체계적으로 분류하여 검색 정확도를 높입니다.

수립된 전략을 바탕으로 실제 데이터를 마크다운으로 변환하고 벡터 DB에 적재하는 실습은 **6장** 에서 통합하여 진행하겠습니다.

**6장으로 이동하여 지식 저장소를 구축합니다.**
